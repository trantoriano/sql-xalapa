-- SINRV2020_024: Cobertura ≠ ('05', '13', '14')
CREATE OR REPLACE VIEW AUTO_IND.VW_SINRV2020_024 AS
SELECT *
FROM AUTO_IND.RR8AUISIN2016SF
WHERE Cobertura IN ('05', '13', '14');

-- SINRV2020_025: Entidad ≠ '34', '99' y FechaOcurrSin ≤ FechaReporSin
CREATE OR REPLACE VIEW AUTO_IND.VW_SINRV2020_025 AS
SELECT *
FROM AUTO_IND.RR8AUISIN2016SF
WHERE Entidad IN ('34', '99')
   OR FechaReporSin < FechaOcurrSin;

-- SINRV2020_026: Año(FechaPagoSin) = Año(FechaReporSin)
CREATE OR REPLACE VIEW AUTO_IND.VW_SINRV2020_026 AS
SELECT *
FROM AUTO_IND.RR8AUISIN2016SF
WHERE FechaPagoSin IS NOT NULL
  AND EXTRACT(YEAR FROM FechaPagoSin) <> EXTRACT(YEAR FROM FechaReporSin);

-- SINRV2020_027: FechaPagoSin ≥ FechaReporSin
CREATE OR REPLACE VIEW AUTO_IND.VW_SINRV2020_027 AS
SELECT *
FROM AUTO_IND.RR8AUISIN2016SF
WHERE FechaPagoSin IS NOT NULL
  AND FechaReporSin IS NOT NULL
  AND FechaPagoSin < FechaReporSin;

-- SINRV2020_028: Si FechaPagoSin ≠ vacío ⇒ MontoPagado > 0
CREATE OR REPLACE VIEW AUTO_IND.VW_SINRV2020_028 AS
SELECT *
FROM AUTO_IND.RR8AUISIN2016SF
WHERE FechaPagoSin IS NOT NULL
  AND (MontoPagado IS NULL OR MontoPagado <= 0);

-- SINRV2020_029: Si MontoPagado > 0 ⇒ FechaPagoSin ≠ vacío
CREATE OR REPLACE VIEW AUTO_IND.VW_SINRV2020_029 AS
SELECT *
FROM AUTO_IND.RR8AUISIN2016SF
WHERE MontoPagado > 0
  AND (FechaPagoSin IS NULL OR TRIM(FechaPagoSin) = '');

-- SINRV2020_030: FechaReporSin ≤ Fecha de corte
CREATE OR REPLACE VIEW AUTO_IND.VW_SINRV2020_030 AS
SELECT *
FROM AUTO_IND.RR8AUISIN2016SF
WHERE FechaReporSin > '2016-12-31';

-- SINRV2020_031: MontoDeduc ≥ 0
CREATE OR REPLACE VIEW AUTO_IND.VW_SINRV2020_031 AS
SELECT *
FROM AUTO_IND.RR8AUISIN2016SF
WHERE MontoDeduc < 0;

-- SINRV2020_032: Si MontoSalvRecu > 0 y Cobertura = '01' ⇒ TipoPerdida ∈ ('01', '02', '05', '06')
CREATE OR REPLACE VIEW AUTO_IND.VW_SINRV2020_032 AS
SELECT *
FROM AUTO_IND.RR8AUISIN2016SF
WHERE MontoSalvRecu > 0
  AND Cobertura = '01'
  AND TipoPerdida NOT IN ('01', '02', '05', '06');

-- SINRV2020_033: Si MontoSalvRecu > 0 y Cobertura = '02' ⇒ TipoPerdida ∈ ('01', '02')
CREATE OR REPLACE VIEW AUTO_IND.VW_SINRV2020_033 AS
SELECT *
FROM AUTO_IND.RR8AUISIN2016SF
WHERE MontoSalvRecu > 0
  AND Cobertura = '02'
  AND TipoPerdida NOT IN ('01', '02');

-- SINRV2020_034: Si TipoPerdida ∈ ('05', '06') ⇒ Cobertura = '01'
CREATE OR REPLACE VIEW AUTO_IND.VW_SINRV2020_034 AS
SELECT *
FROM AUTO_IND.RR8AUISIN2016SF
WHERE TipoPerdida IN ('05', '06')
  AND Cobertura <> '01';

-- SINRV2020_035: Si TipoPerdida = '07' ⇒ Cobertura = '03'
CREATE OR REPLACE VIEW AUTO_IND.VW_SINRV2020_035 AS
SELECT *
FROM AUTO_IND.RR8AUISIN2016SF
WHERE TipoPerdida = '07'
  AND Cobertura <> '03';
