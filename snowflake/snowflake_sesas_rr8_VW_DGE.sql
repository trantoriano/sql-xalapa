-- DGERV2020_001: ClaveInsCoaseg ≠ Clave propia (NumPoliza se usa como base comparativa si aplica)
CREATE OR REPLACE VIEW AUTO_IND.VW_DGERV2020_001 AS
SELECT *
FROM AUTO_IND.RR8AUIDGE2016SF
WHERE ClaveInsCoaseg = ClaveAMIS
  AND TRIM(ClaveInsCoaseg) <> '';

-- DGERV2020_002: Si existe clave de coaseguro ⇒ porcentaje > 0
CREATE OR REPLACE VIEW AUTO_IND.VW_DGERV2020_002 AS
SELECT *
FROM AUTO_IND.RR8AUIDGE2016SF
WHERE ClaveInsCoaseg IS NOT NULL AND TRIM(ClaveInsCoaseg) <> ''
  AND (PorcentajeCoaseg IS NULL OR PorcentajeCoaseg <= 0);

-- DGERV2020_003: Entidad ≠ 34
CREATE OR REPLACE VIEW AUTO_IND.VW_DGERV2020_003 AS
SELECT *
FROM AUTO_IND.RR8AUIDGE2016SF
WHERE Entidad = '34';

-- DGERV2020_004: Entidad ≠ 99
CREATE OR REPLACE VIEW AUTO_IND.VW_DGERV2020_004 AS
SELECT *
FROM AUTO_IND.RR8AUIDGE2016SF
WHERE Entidad = '99';

-- DGERV2020_005: Si Estatus = 1 entonces FechaFinVig > FechaCorte
CREATE OR REPLACE VIEW AUTO_IND.VW_DGERV2020_005 AS
SELECT *
FROM AUTO_IND.RR8AUIDGE2016SF
WHERE Estatus = '1' AND FechaFinVig <= '2016-12-31';

-- DGERV2020_006: Si Estatus = 5 entonces FechaFinVig ≤ FechaCorte
CREATE OR REPLACE VIEW AUTO_IND.VW_DGERV2020_006 AS
SELECT *
FROM AUTO_IND.RR8AUIDGE2016SF
WHERE Estatus = '5' AND FechaFinVig > '2016-12-31';

-- DGERV2020_007: Estatus ≠ 7 ni 8
CREATE OR REPLACE VIEW AUTO_IND.VW_DGERV2020_007 AS
SELECT *
FROM AUTO_IND.RR8AUIDGE2016SF
WHERE Estatus IN ('7', '8');

-- DGERV2020_008: Si FechaInVig > Corte y sin cancelación ⇒ Estatus = 0
CREATE OR REPLACE VIEW AUTO_IND.VW_DGERV2020_008 AS
SELECT *
FROM AUTO_IND.RR8AUIDGE2016SF
WHERE FechaInVig > '2016-12-31'
  AND (FechaCancela IS NULL OR TRIM(FechaCancela) = '')
  AND Estatus <> '0';

-- DGERV2020_009: Si Estatus = 0 entonces Inicio de vigencia > corte
CREATE OR REPLACE VIEW AUTO_IND.VW_DGERV2020_009 AS
SELECT *
FROM AUTO_IND.RR8AUIDGE2016SF
WHERE Estatus = '0' AND FechaInVig <= '2016-12-31';

-- DGERV2020_010: Porcentaje de coaseguro fuera de rango 0-99
CREATE OR REPLACE VIEW AUTO_IND.VW_DGERV2020_010 AS
SELECT *
FROM AUTO_IND.RR8AUIDGE2016SF
WHERE PorcentajeCoaseg < 0 OR PorcentajeCoaseg > 99;

-- DGERV2020_011: Si PorcentajeCoaseg > 0 entonces ClaveInsCoaseg ≠ vacío
CREATE OR REPLACE VIEW AUTO_IND.VW_DGERV2020_011 AS
SELECT *
FROM AUTO_IND.RR8AUIDGE2016SF
WHERE PorcentajeCoaseg > 0
  AND (ClaveInsCoaseg IS NULL OR TRIM(ClaveInsCoaseg) = '');

-- DGERV2020_012: Si PorcentajeCoaseg = 0 entonces ClaveInsCoaseg = vacío
CREATE OR REPLACE VIEW AUTO_IND.VW_DGERV2020_012 AS
SELECT *
FROM AUTO_IND.RR8AUIDGE2016SF
WHERE PorcentajeCoaseg = 0
  AND ClaveInsCoaseg IS NOT NULL
  AND TRIM(ClaveInsCoaseg) <> '';

-- DGERV2020_013: TipoPago debe ser 1 o 2
CREATE OR REPLACE VIEW AUTO_IND.VW_DGERV2020_013 AS
SELECT *
FROM AUTO_IND.RR8AUIDGE2016SF
WHERE TipoPago NOT IN ('1', '2');

-- DGERV2020_014: Uso del vehículo ≠ “15”
CREATE OR REPLACE VIEW AUTO_IND.VW_DGERV2020_014 AS
SELECT *
FROM AUTO_IND.RR8AUIDGE2016SF
WHERE UsoVehiculo = '15';